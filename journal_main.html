<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>í•˜ë£¨í•œì¤„ â€” ë‚˜ë§Œì˜ í•˜ë£¨ ê¸°ë¡</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Noto Sans KR', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: #F5F0E8;
      color: #4A3728;
      line-height: 1.7;
      -webkit-font-smoothing: antialiased;
    }
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #D4B896; border-radius: 3px; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useRef, useEffect } = React;

    // â”€â”€â”€ Design Tokens (í•˜ë£¨í•œì¤„ ë² ì´ì§€ í…Œë§ˆ) â”€â”€â”€
    const T = {
      bg: "#F5F0E8", card: "#FFFCF7", accent: "#B8956A", accentLight: "#D4B896",
      accentBg: "#F0E6D6", text: "#4A3728", textSub: "#8B7355", border: "#E8DFD0",
      white: "#fff", hover: "#EDE5D8", shadow: "0 2px 12px rgba(139,115,85,0.08)",
      shadowHover: "0 6px 24px rgba(139,115,85,0.14)",
      gradient: "linear-gradient(135deg, #B8956A, #9B7B5A)",
    };

    const EMOTIONS = {
      happy: { emoji: "ğŸ˜Š", label: "í–‰ë³µ", color: "#E8A87C" },
      sad: { emoji: "ğŸ˜¢", label: "ìŠ¬í””", color: "#8BA4B8" },
      angry: { emoji: "ğŸ˜ ", label: "ë¶„ë…¸", color: "#C97064" },
      anxious: { emoji: "ğŸ˜°", label: "ë¶ˆì•ˆ", color: "#A688B0" },
      peaceful: { emoji: "ğŸ˜Œ", label: "í‰ì˜¨", color: "#8DB580" },
      excited: { emoji: "ğŸ¤©", label: "ì„¤ë ˜", color: "#D4897C" },
      tired: { emoji: "ğŸ˜´", label: "í”¼ê³¤", color: "#A0998E" },
      grateful: { emoji: "ğŸ¥°", label: "ê°ì‚¬", color: "#C4A265" },
      lonely: { emoji: "ğŸ¥º", label: "ì™¸ë¡œì›€", color: "#9678A0" },
      proud: { emoji: "ğŸ’ª", label: "ë¿Œë“¯", color: "#C49555" },
    };

    const ACTIVITIES = ["ğŸƒ ìš´ë™", "ğŸ“š ë…ì„œ", "ğŸµ ìŒì•…", "ğŸ³ ìš”ë¦¬", "ğŸ® ê²Œì„", "â˜• ì¹´í˜", "ğŸ¬ ì˜í™”", "ğŸ’» ì½”ë”©", "ğŸ§˜ ëª…ìƒ", "ğŸ“¸ ì‚¬ì§„"];

    const MOCK = [
      {
        id: 1, date: "2026-02-12", title: "ë´„ì´ ì˜¤ëŠ” ëŠë‚Œì˜ í•˜ë£¨",
        emotions: [{ key: "happy", intensity: 4 }, { key: "grateful", intensity: 3 }, { key: "peaceful", intensity: 2 }],
        places: [{ name: "í•œë‚¨ë™ ì¹´í˜", isFirst: false }, { name: "ì´íƒœì› ê³¨ëª©ê¸¸", isFirst: true }],
        payments: [{ store: "ì¹´í˜ ì˜¨ë„", amount: 8500, category: "ì¹´í˜" }, { store: "ì´íƒœì› íŒŒìŠ¤íƒ€ì§‘", amount: 36500, category: "ì™¸ì‹" }],
        activities: ["â˜• ì¹´í˜", "ğŸ“¸ ì‚¬ì§„"],
        content: "ì˜¤ëŠ˜ì€ ë‚ ì”¨ê°€ ìœ ë‚œíˆ ë”°ëœ»í–ˆë‹¤. ê²¨ìš¸ì´ ëë‚˜ê°€ëŠ” ëŠë‚Œì´ ì˜¨ëª¸ìœ¼ë¡œ ì „í•´ì¡Œë‹¤.\n\ní•œë‚¨ë™ ì¹´í˜ì—ì„œ ë¼ë–¼ í•œ ì”ì„ ë§ˆì‹œë©´ì„œ ì°½ë°–ì„ ë°”ë¼ë´¤ë‹¤. ì‚¬ëŒë“¤ì´ í•˜ë‚˜ë‘˜ ê²‰ì˜·ì„ ë²—ê¸° ì‹œì‘í–ˆë‹¤. ê·¸ ëª¨ìŠµì„ ë³´ëŠ” ê²ƒë§Œìœ¼ë¡œë„ ê¸°ë¶„ì´ ì¢‹ì•˜ë‹¤.\n\nì˜¤í›„ì—ëŠ” ì´íƒœì› ê³¨ëª©ê¸¸ì„ ì²˜ìŒ ê±¸ì–´ë´¤ë‹¤. ì‘ì€ ë¹ˆí‹°ì§€ ê°€ê²Œë“¤, í–¥ì´ ì¢‹ì€ í–¥ì´ˆ ê°€ê²Œ, ì•„ê¸°ìê¸°í•œ ì†Œí’ˆë“¤. ë‹¤ìŒì—ë„ ê¼­ ë‹¤ì‹œ ì˜¤ê³  ì‹¶ë‹¤.\n\nì´ëŸ° í‰ë²”í•œ ì¼ìƒì´ ì°¸ ê°ì‚¬í•˜ë‹¤.",
        totalSpending: 45000, steps: 12340,
      },
      {
        id: 2, date: "2026-02-11", title: "íšŒì‚¬ì—ì„œ ì¢‹ì€ í”¼ë“œë°±ì„ ë°›ì€ ë‚ ",
        emotions: [{ key: "proud", intensity: 4 }, { key: "happy", intensity: 3 }, { key: "excited", intensity: 3 }],
        places: [{ name: "ê°•ë‚¨ ì˜¤í”¼ìŠ¤", isFirst: false }, { name: "ì—­ì‚¼ë™ ë§›ì§‘", isFirst: true }],
        payments: [{ store: "ì—­ì‚¼ ê¹€ë°¥ì²œêµ­", amount: 7000, category: "ì™¸ì‹" }, { store: "GS25", amount: 5000, category: "í¸ì˜ì " }, { store: "ìŠ¤íƒ€ë²…ìŠ¤ ê°•ë‚¨ì ", amount: 20000, category: "ì¹´í˜" }],
        activities: ["ğŸ’» ì½”ë”©", "â˜• ì¹´í˜"],
        content: "í”„ë¡œì íŠ¸ ë°œí‘œë¥¼ í–ˆëŠ”ë° íŒ€ì¥ë‹˜ì´ ì •ë§ ì˜í–ˆë‹¤ê³  ì¹­ì°¬í•´ì£¼ì…¨ë‹¤. 3ì£¼ ë™ì•ˆ ì•¼ê·¼í•˜ë©° ì¤€ë¹„í•œ ë³´ëŒì´ ìˆì—ˆë‹¤.\n\nì ì‹¬ì€ ì—­ì‚¼ë™ì— ìƒˆë¡œ ìƒê¸´ ë§›ì§‘ì— ê°”ë‹¤. ì²˜ìŒ ê°€ë´¤ëŠ”ë° ë¶„ìœ„ê¸°ë„ ì¢‹ê³  ìŒì‹ë„ ë§›ìˆì—ˆë‹¤.\n\ní‡´ê·¼ í›„ ìŠ¤íƒ€ë²…ìŠ¤ì—ì„œ ë‹¤ìŒ í”„ë¡œì íŠ¸ ê¸°íšì„ ì ê¹ ì •ë¦¬í–ˆë‹¤. ì´ ê¸°ì„¸ë¥¼ ì´ì–´ê°€ê³  ì‹¶ë‹¤.",
        totalSpending: 32000, steps: 8200,
      },
      {
        id: 3, date: "2026-02-10", title: "ë¹„ ì˜¤ëŠ” ì¼ìš”ì¼",
        emotions: [{ key: "peaceful", intensity: 3 }, { key: "sad", intensity: 2 }, { key: "lonely", intensity: 2 }],
        places: [{ name: "ì§‘", isFirst: false }, { name: "ë™ë„¤ í¸ì˜ì ", isFirst: false }],
        payments: [{ store: "CU í¸ì˜ì ", amount: 8000, category: "í¸ì˜ì " }],
        activities: ["ğŸ¬ ì˜í™”", "ğŸµ ìŒì•…"],
        content: "ë¹„ê°€ ë§ì´ ì™€ì„œ í•˜ë£¨ì¢…ì¼ ì§‘ì— ìˆì—ˆë‹¤. ë„·í”Œë¦­ìŠ¤ì—ì„œ 'ë” ê¸€ë¡œë¦¬'ë¥¼ ì •ì£¼í–‰í–ˆë‹¤.\n\nì¤‘ê°„ì— í¸ì˜ì ì— ê°€ì„œ ì‚¼ê°ê¹€ë°¥ì´ë‘ ë¼ë©´ì„ ì‚¬ì™”ë‹¤. ë¹„ ë§ìœ¼ë©´ì„œ ê±¸ìœ¼ë‹ˆê¹Œ ë¬˜í•˜ê²Œ ì„¼ì¹˜í•´ì¡Œë‹¤.\n\nì €ë…ì—ëŠ” ì¬ì¦ˆ í”Œë ˆì´ë¦¬ìŠ¤íŠ¸ë¥¼ í‹€ì–´ë†“ê³  ë©ë•Œë ¸ë‹¤. ê°€ë”ì€ ì´ëŸ° ë‚ ë„ í•„ìš”í•˜ë‹¤.",
        totalSpending: 8000, steps: 2100,
      },
      {
        id: 4, date: "2026-02-09", title: "ì¹œêµ¬ë“¤ê³¼ ì‹ ë‚˜ëŠ” í† ìš”ì¼",
        emotions: [{ key: "happy", intensity: 4 }, { key: "excited", intensity: 4 }, { key: "grateful", intensity: 3 }],
        places: [{ name: "í™ëŒ€ í´ëŸ½ê±°ë¦¬", isFirst: false }, { name: "ì—°ë‚¨ë™ ë¸ŒëŸ°ì¹˜ì¹´í˜", isFirst: true }, { name: "ë§ì› í•œê°•ê³µì›", isFirst: false }],
        payments: [{ store: "ì—°ë‚¨ë™ ë¸ŒëŸ°ì¹˜ì¹´í˜", amount: 28000, category: "ì™¸ì‹" }, { store: "í•œê°• í¸ì˜ì ", amount: 15000, category: "í¸ì˜ì " }, { store: "íƒì‹œ", amount: 16000, category: "êµí†µ" }, { store: "í™ëŒ€ ë°”", amount: 30000, category: "ìœ í¥" }],
        activities: ["ğŸƒ ìš´ë™", "ğŸ“¸ ì‚¬ì§„", "â˜• ì¹´í˜"],
        content: "ì˜¤ëœë§Œì— ëŒ€í•™êµ ì¹œêµ¬ë“¤ì„ ë§Œë‚¬ë‹¤! ì—°ë‚¨ë™ì—ì„œ ë¸ŒëŸ°ì¹˜ë¥¼ ë¨¹ê³ , í•œê°•ê¹Œì§€ ê±¸ì–´ê°”ë‹¤.\n\ní•œê°•ì—ì„œ ì¹˜ë§¥í•˜ë©´ì„œ ëŒ€í•™ ë•Œ ì¶”ì–µì–˜ê¸°ë¥¼ í–ˆë‹¤. ì‹œê°„ì´ ì •ë§ ë¹¨ë¦¬ ê°„ë‹¤.\n\nì €ë…ì—ëŠ” í™ëŒ€ì—ì„œ í•œì” ë” í•˜ê³  íƒì‹œíƒ€ê³  ì§‘ì— ì™”ë‹¤. í–‰ë³µí•œ í•˜ë£¨!",
        totalSpending: 89000, steps: 18500,
      },
      {
        id: 5, date: "2026-02-08", title: "ì•¼ê·¼ì˜ ì—°ì†",
        emotions: [{ key: "tired", intensity: 4 }, { key: "anxious", intensity: 3 }, { key: "sad", intensity: 2 }],
        places: [{ name: "ê°•ë‚¨ ì˜¤í”¼ìŠ¤", isFirst: false }, { name: "GS25", isFirst: false }],
        payments: [{ store: "GS25", amount: 8000, category: "í¸ì˜ì " }, { store: "ë°°ë‹¬ì˜ë¯¼ì¡±", amount: 7000, category: "ë°°ë‹¬" }],
        activities: ["ğŸ’» ì½”ë”©"],
        content: "ì´ë²ˆ ì£¼ ì„¸ë²ˆì§¸ ì•¼ê·¼ì´ë‹¤. í”„ë¡œì íŠ¸ ë§ˆê°ì´ ë‹¤ê°€ì™€ì„œ ìŠ¤íŠ¸ë ˆìŠ¤ê°€ ì‹¬í•˜ë‹¤.\n\nì €ë…ì€ í¸ì˜ì  ë„ì‹œë½ìœ¼ë¡œ í•´ê²°í–ˆë‹¤. ë°¤ 11ì‹œì— í‡´ê·¼í•˜ë©´ì„œ ì•¼ê²½ì„ ë´¤ëŠ”ë°, ì˜ˆì˜ê¸´ í•œë° ê³µí—ˆí–ˆë‹¤.\n\në‚´ì¼ì€ ì œë°œ ì •ì‹œí‡´ê·¼í•˜ê³  ì‹¶ë‹¤.",
        totalSpending: 15000, steps: 4200,
      },
      {
        id: 6, date: "2026-02-07", title: "ìƒˆë¡œìš´ ì·¨ë¯¸ë¥¼ ì‹œì‘í•œ ë‚ ",
        emotions: [{ key: "excited", intensity: 4 }, { key: "happy", intensity: 3 }, { key: "anxious", intensity: 1 }],
        places: [{ name: "ì„œì´ˆ ë„ì˜ˆê³µë°©", isFirst: true }, { name: "ê°•ë‚¨ì—­ ì§€í•˜ìƒê°€", isFirst: false }],
        payments: [{ store: "ì„œì´ˆ ë„ì˜ˆê³µë°©", amount: 55000, category: "ì·¨ë¯¸" }, { store: "ë‹¤ì´ì†Œ", amount: 10000, category: "ì‡¼í•‘" }],
        activities: ["ğŸ§˜ ëª…ìƒ", "ğŸ“¸ ì‚¬ì§„"],
        content: "ë„ì˜ˆ ì›ë°ì´ í´ë˜ìŠ¤ë¥¼ ë‹¤ë…€ì™”ë‹¤. ì²˜ìŒ í•´ë³´ëŠ” ê±°ë¼ ê¸´ì¥í–ˆëŠ”ë° ì„ ìƒë‹˜ì´ ì¹œì ˆí•˜ì…”ì„œ ê¸ˆë°© ì ì‘í–ˆë‹¤.\n\ní™ì„ ë§Œì§€ëŠ” ê°ì´‰ì´ ìƒê°ë³´ë‹¤ ì¹˜ìœ ë˜ëŠ” ëŠë‚Œì´ì—ˆë‹¤. ì»µ í•˜ë‚˜ë¥¼ ë§Œë“¤ì—ˆëŠ”ë° 2ì£¼ í›„ì— ì™„ì„±ëœë‹¤ê³  í•œë‹¤. ê¸°ëŒ€ëœë‹¤!\n\nëŒì•„ì˜¤ëŠ” ê¸¸ì— ë‹¤ì´ì†Œì—ì„œ ì´ê²ƒì €ê²ƒ ìƒ€ë‹¤.",
        totalSpending: 65000, steps: 9800,
      },
      {
        id: 7, date: "2026-02-06", title: "í‰ë²”í•œ í•˜ë£¨",
        emotions: [{ key: "peaceful", intensity: 2 }, { key: "tired", intensity: 2 }],
        places: [{ name: "ê°•ë‚¨ ì˜¤í”¼ìŠ¤", isFirst: false }, { name: "ì§‘", isFirst: false }],
        payments: [{ store: "íšŒì‚¬ êµ¬ë‚´ì‹ë‹¹", amount: 0, category: "ì‹ì‚¬" }, { store: "í¸ì˜ì ", amount: 3000, category: "í¸ì˜ì " }],
        activities: ["ğŸ’» ì½”ë”©", "ğŸ“š ë…ì„œ"],
        content: "íŠ¹ë³„í•œ ì¼ ì—†ì´ í‰ë²”í•˜ê²Œ íšŒì‚¬ ë‹¤ë…€ì™”ë‹¤. ì ì‹¬ì€ êµ¬ë‚´ì‹ë‹¹ì—ì„œ ë¨¹ì—ˆë‹¤.\n\ní‡´ê·¼ í›„ ì§‘ì—ì„œ ì±…ì„ ì¡°ê¸ˆ ì½ì—ˆë‹¤. 'ì›ì”½'ì´ë¼ëŠ” ì±…ì¸ë° ì§‘ì¤‘ì˜ ì¤‘ìš”ì„±ì— ëŒ€í•´ ì´ì•¼ê¸°í•œë‹¤.\n\nì´ëŸ° í‰ë²”í•œ ë‚ ë„ ë‚˜ë¦„ ì¢‹ë‹¤.",
        totalSpending: 3000, steps: 6400,
      },
      {
        id: 8, date: "2026-02-05", title: "ë¶€ëª¨ë‹˜ê³¼ì˜ ì €ë…ì‹ì‚¬",
        emotions: [{ key: "grateful", intensity: 4 }, { key: "happy", intensity: 4 }, { key: "peaceful", intensity: 3 }],
        places: [{ name: "ì••êµ¬ì • í•œì •ì‹", isFirst: true }, { name: "ë¶€ëª¨ë‹˜ ëŒ", isFirst: false }],
        payments: [],
        activities: ["ğŸ³ ìš”ë¦¬"],
        content: "ë¶€ëª¨ë‹˜ì´ ë§›ìˆëŠ” í•œì •ì‹ì„ ì‚¬ì£¼ì…¨ë‹¤. ì••êµ¬ì •ì— ìƒˆë¡œ ìƒê¸´ ê³³ì¸ë° ì •ë§ ë§›ìˆì—ˆë‹¤.\n\nì‹ì‚¬ í›„ì— ë¶€ëª¨ë‹˜ ëŒì— ê°€ì„œ ì°¨ í•œì” í–ˆë‹¤. ì—„ë§ˆê°€ ì§ì ‘ ë§Œë“  ì•½ê³¼ë¥¼ ì‹¸ì£¼ì…¨ë‹¤.\n\në¶€ëª¨ë‹˜ì´ ê±´ê°•í•˜ê²Œ ê³„ì…”ì£¼ëŠ” ê²ƒë§Œìœ¼ë¡œë„ ì •ë§ ê°ì‚¬í•˜ë‹¤.",
        totalSpending: 0, steps: 5100,
      },
    ];

    const fmt = (d) => { const x = new Date(d); const w = ["ì¼","ì›”","í™”","ìˆ˜","ëª©","ê¸ˆ","í† "]; return `${x.getFullYear()}.${x.getMonth()+1}.${x.getDate()} (${w[x.getDay()]})`; };
    const isToday = (d) => d === "2026-02-12";
    const money = (n) => n.toLocaleString() + "ì›";

    // â”€â”€â”€ Treemap â”€â”€â”€
    const Treemap = ({ data, width, height }) => {
      const total = data.reduce((s, d) => s + d.value, 0);
      if (total === 0) return null;
      let rects = [], x = 0, y = 0, w = width, h = height, rem = [...data].sort((a, b) => b.value - a.value), rt = total;
      rem.forEach((item) => {
        const ratio = item.value / rt;
        const hz = w >= h;
        const rw = hz ? w * ratio : w, rh = hz ? h : h * ratio;
        rects.push({ ...item, x, y, w: rw, h: rh });
        if (hz) { x += rw; w -= rw; } else { y += rh; h -= rh; }
        rt -= item.value;
      });
      return (
        <svg width={width} height={height} style={{ borderRadius: 12 }}>
          {rects.map((r, i) => (
            <g key={i}>
              <rect x={r.x} y={r.y} width={Math.max(r.w, 0)} height={Math.max(r.h, 0)} fill={r.color} stroke={T.card} strokeWidth={2} rx={6} />
              {r.w > 55 && r.h > 40 && (<React.Fragment>
                <text x={r.x + r.w / 2} y={r.y + r.h / 2 - 8} textAnchor="middle" fill="#fff" fontSize={r.w > 90 ? 22 : 16} fontWeight="bold">{r.emoji}</text>
                <text x={r.x + r.w / 2} y={r.y + r.h / 2 + 12} textAnchor="middle" fill="#fff" fontSize={r.w > 90 ? 13 : 10} fontWeight="600">{r.label}</text>
                <text x={r.x + r.w / 2} y={r.y + r.h / 2 + 26} textAnchor="middle" fill="rgba(255,255,255,0.75)" fontSize={r.w > 90 ? 11 : 8}>{r.count}íšŒ</text>
              </React.Fragment>)}
            </g>
          ))}
        </svg>
      );
    };

    // â”€â”€â”€ Diary Detail (ì¼ê¸° ìƒì„¸) â”€â”€â”€
    const DiaryDetail = ({ diary, onBack }) => {
      if (!diary) return null;
      const sec = { background: T.card, borderRadius: 16, padding: "24px 28px", marginBottom: 16, border: `1px solid ${T.border}` };
      return (
        <div style={{ maxWidth: 720, margin: "0 auto" }}>
          <button onClick={onBack} style={{ background: "none", border: "none", color: T.accent, fontSize: 14, fontWeight: 600, cursor: "pointer", marginBottom: 16, display: "flex", alignItems: "center", gap: 6 }}>
            â† ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°
          </button>
          {/* Header */}
          <div style={{ ...sec, padding: "32px 28px" }}>
            <div style={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start" }}>
              <div>
                <div style={{ fontSize: 13, color: T.textSub, marginBottom: 6 }}>{fmt(diary.date)}{isToday(diary.date) && <span style={{ background: T.accent, color: "#fff", fontSize: 10, padding: "2px 10px", borderRadius: 10, marginLeft: 10 }}>ì˜¤ëŠ˜</span>}</div>
                <div style={{ fontSize: 24, fontWeight: 700, color: T.text }}>{diary.title}</div>
              </div>
              {isToday(diary.date) && <button onClick={() => { window.location.href = "journal.html"; }} style={{ background: T.accentBg, border: `1px solid ${T.accentLight}`, borderRadius: 10, padding: "8px 18px", fontSize: 13, color: T.accent, fontWeight: 600, cursor: "pointer" }}>ìˆ˜ì •í•˜ê¸°</button>}
            </div>
          </div>

          {/* Content */}
          <div style={sec}>
            <div style={{ fontSize: 14, fontWeight: 600, color: T.accent, marginBottom: 14 }}>ğŸ“– ì˜¤ëŠ˜ì˜ ì´ì•¼ê¸°</div>
            <div style={{ fontSize: 15, color: T.text, lineHeight: 1.9, whiteSpace: "pre-line" }}>{diary.content}</div>
          </div>

          {/* Two Column */}
          <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 16, marginBottom: 16 }}>
            {/* Emotions */}
            <div style={{ ...sec, marginBottom: 0 }}>
              <div style={{ fontSize: 14, fontWeight: 600, color: T.accent, marginBottom: 14 }}>ğŸ­ ê°ì •</div>
              <div style={{ display: "flex", flexDirection: "column", gap: 10 }}>
                {diary.emotions.map(e => (
                  <div key={e.key} style={{ display: "flex", alignItems: "center", gap: 12 }}>
                    <span style={{ fontSize: 24 }}>{EMOTIONS[e.key]?.emoji}</span>
                    <div style={{ flex: 1 }}>
                      <div style={{ fontSize: 13, fontWeight: 600, color: T.text, marginBottom: 4 }}>{EMOTIONS[e.key]?.label}</div>
                      <div style={{ height: 6, background: T.accentBg, borderRadius: 3, overflow: "hidden" }}>
                        <div style={{ height: "100%", width: `${e.intensity * 25}%`, background: EMOTIONS[e.key]?.color, borderRadius: 3 }} />
                      </div>
                    </div>
                    <span style={{ fontSize: 12, color: T.textSub, fontWeight: 600 }}>{e.intensity}/4</span>
                  </div>
                ))}
              </div>
            </div>
            {/* Activities */}
            <div style={{ ...sec, marginBottom: 0 }}>
              <div style={{ fontSize: 14, fontWeight: 600, color: T.accent, marginBottom: 14 }}>ğŸ·ï¸ í™œë™</div>
              <div style={{ display: "flex", flexWrap: "wrap", gap: 8 }}>
                {diary.activities.map(a => (
                  <span key={a} style={{ background: T.accentBg, color: T.accent, padding: "8px 16px", borderRadius: 20, fontSize: 13, fontWeight: 600, border: `1px solid ${T.border}` }}>{a}</span>
                ))}
              </div>
              <div style={{ marginTop: 20 }}>
                <div style={{ fontSize: 14, fontWeight: 600, color: T.accent, marginBottom: 10 }}>ğŸš¶ ê±¸ìŒ ìˆ˜</div>
                <div style={{ fontSize: 28, fontWeight: 700, color: T.text }}>{diary.steps?.toLocaleString()}<span style={{ fontSize: 14, color: T.textSub, fontWeight: 500 }}> ê±¸ìŒ</span></div>
              </div>
            </div>
          </div>

          {/* Two Column: Places & Payments */}
          <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 16 }}>
            {/* Places */}
            <div style={{ ...sec, marginBottom: 0 }}>
              <div style={{ fontSize: 14, fontWeight: 600, color: T.accent, marginBottom: 14 }}>ğŸ“ ë°©ë¬¸ ì¥ì†Œ</div>
              <div style={{ display: "flex", flexDirection: "column", gap: 8 }}>
                {diary.places.map((p, i) => (
                  <div key={i} style={{ display: "flex", alignItems: "center", gap: 10, padding: "8px 12px", background: p.isFirst ? "#FFF8F0" : T.bg, borderRadius: 10, border: p.isFirst ? `1px solid ${T.accentLight}` : `1px solid ${T.border}` }}>
                    <span style={{ fontSize: 16 }}>{p.isFirst ? "âœ¨" : "ğŸ“"}</span>
                    <span style={{ fontSize: 13, fontWeight: 600, color: T.text }}>{p.name}</span>
                    {p.isFirst && <span style={{ fontSize: 10, background: T.accent, color: "#fff", padding: "2px 8px", borderRadius: 8, fontWeight: 600, marginLeft: "auto" }}>ì²« ë°©ë¬¸</span>}
                  </div>
                ))}
              </div>
            </div>
            {/* Payments */}
            <div style={{ ...sec, marginBottom: 0 }}>
              <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 14 }}>
                <div style={{ fontSize: 14, fontWeight: 600, color: T.accent }}>ğŸ’³ ê²°ì œ ë‚´ì—­</div>
                <div style={{ fontSize: 14, fontWeight: 700, color: T.text }}>ì´ {money(diary.totalSpending)}</div>
              </div>
              {diary.payments.length === 0 ? (
                <div style={{ fontSize: 13, color: T.textSub, textAlign: "center", padding: 16 }}>ê²°ì œ ë‚´ì—­ì´ ì—†ì–´ìš”</div>
              ) : (
                <div style={{ display: "flex", flexDirection: "column", gap: 8 }}>
                  {diary.payments.map((p, i) => (
                    <div key={i} style={{ display: "flex", justifyContent: "space-between", alignItems: "center", padding: "8px 12px", background: T.bg, borderRadius: 10, border: `1px solid ${T.border}` }}>
                      <div>
                        <div style={{ fontSize: 13, fontWeight: 600, color: T.text }}>{p.store}</div>
                        <div style={{ fontSize: 11, color: T.textSub }}>{p.category}</div>
                      </div>
                      <div style={{ fontSize: 14, fontWeight: 700, color: T.text }}>{money(p.amount)}</div>
                    </div>
                  ))}
                </div>
              )}
            </div>
          </div>
        </div>
      );
    };

    // â”€â”€â”€ AI Chat â”€â”€â”€
    const AIChatModal = ({ onClose, diaries }) => {
      const [msgs, setMsgs] = useState([{ role: "ai", text: "ì•ˆë…•í•˜ì„¸ìš”! í•˜ë£¨í•œì¤„ AI ë¶„ì„ ë„ìš°ë¯¸ì˜ˆìš” â˜•\n\nì‘ì„±í•œ ì¼ê¸°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì§ˆë¬¸í•´ì£¼ì„¸ìš”.\n\nâ€¢ \"ìµœê·¼ì— ì–´ë””ì— ëˆì„ ë§ì´ ì¼ì–´?\"\nâ€¢ \"ìì£¼ ë°©ë¬¸í•œ ê³³ì€ ì–´ë””ì•¼?\"\nâ€¢ \"ë‚´ ì£¼ëœ ê°ì • íë¦„ì€ ì–´ë•Œ?\"" }]);
      const [input, setInput] = useState("");
      const [loading, setLoading] = useState(false);
      const ref = useRef(null);
      useEffect(() => { ref.current?.scrollTo(0, ref.current.scrollHeight); }, [msgs]);

      const analyze = (q) => {
        const l = q.toLowerCase();
        if (l.includes("ëˆ") || l.includes("ì§€ì¶œ") || l.includes("ì¼")) {
          const tot = diaries.reduce((s, d) => s + d.totalSpending, 0);
          const sorted = [...diaries].sort((a, b) => b.totalSpending - a.totalSpending);
          return `ğŸ’° ì´ ì§€ì¶œ: ${money(tot)}\n\nê°€ì¥ ë§ì´ ì“´ ë‚ :\n1. ${sorted[0].date} â€” ${money(sorted[0].totalSpending)} (${sorted[0].title})\n2. ${sorted[1].date} â€” ${money(sorted[1].totalSpending)} (${sorted[1].title})\n3. ${sorted[2].date} â€” ${money(sorted[2].totalSpending)} (${sorted[2].title})\n\nì™¸ì‹ê³¼ ì¹´í˜ ë°©ë¬¸ ì‹œ ì§€ì¶œì´ í° í¸ì´ì—ìš”.`;
        }
        if (l.includes("ë°©ë¬¸") || l.includes("ì¥ì†Œ") || l.includes("ì–´ë””")) {
          const pc = {};
          diaries.forEach(d => d.places.forEach(p => { pc[p.name] = (pc[p.name] || 0) + 1; }));
          const sorted = Object.entries(pc).sort((a, b) => b[1] - a[1]).slice(0, 5);
          return `ğŸ“ ìì£¼ ë°©ë¬¸í•œ ì¥ì†Œ TOP 5:\n${sorted.map(([p, c], i) => `${i + 1}. ${p} (${c}íšŒ)`).join("\n")}\n\nì£¼ì¤‘ì—ëŠ” ê°•ë‚¨ ì˜¤í”¼ìŠ¤, ì£¼ë§ì—ëŠ” í™ëŒ€/ì—°ë‚¨ë™ ìª½ì„ ìì£¼ ë°©ë¬¸í•˜ì‹œë„¤ìš”!`;
        }
        if (l.includes("ê°ì •") || l.includes("ê¸°ë¶„") || l.includes("ëŠë‚Œ")) {
          const ec = {};
          diaries.forEach(d => d.emotions.forEach(e => { ec[e.key] = (ec[e.key] || 0) + 1; }));
          const sorted = Object.entries(ec).sort((a, b) => b[1] - a[1]);
          return `ğŸ­ ê°ì • ë¶„ì„:\n${sorted.map(([e, c], i) => `${i + 1}. ${EMOTIONS[e]?.emoji} ${EMOTIONS[e]?.label} (${c}íšŒ)`).join("\n")}\n\nì „ë°˜ì ìœ¼ë¡œ í–‰ë³µê³¼ ê°ì‚¬ë¥¼ ë§ì´ ëŠë¼ì‹œëŠ” í¸ì´ì—ìš”. ì£¼ë§ì— ì¶©ë¶„í•œ íšŒë³µì„ í•˜ì‹œëŠ” íŒ¨í„´ì´ ë³´ì—¬ìš”!`;
        }
        return `â˜• ${diaries.length}ê°œì˜ ì¼ê¸°ë¥¼ ë¶„ì„í•´ë³´ë©´, ìµœê·¼ ì „ë°˜ì ìœ¼ë¡œ ê¸ì •ì ì¸ ê°ì •ì´ ìš°ì„¸í•˜ë©° ìƒˆë¡œìš´ ì¥ì†Œ íƒë°©ì„ ì¦ê¸°ì‹œëŠ” í¸ì´ì—ìš”.\n\në” êµ¬ì²´ì ì¸ ì§ˆë¬¸ì„ í•´ì£¼ì‹œë©´ ìì„¸íˆ ë¶„ì„í•´ë“œë¦´ê²Œìš”!`;
      };

      const send = () => {
        if (!input.trim()) return;
        const q = input; setInput(""); setMsgs(p => [...p, { role: "user", text: q }]); setLoading(true);
        setTimeout(() => { setMsgs(p => [...p, { role: "ai", text: analyze(q) }]); setLoading(false); }, 1000);
      };

      return (
        <div style={{ position: "fixed", inset: 0, background: "rgba(74,55,40,0.4)", zIndex: 1000, display: "flex", alignItems: "center", justifyContent: "center", backdropFilter: "blur(4px)" }} onClick={onClose}>
          <div onClick={e => e.stopPropagation()} style={{ background: T.card, borderRadius: 24, width: 480, height: 620, display: "flex", flexDirection: "column", overflow: "hidden", boxShadow: "0 20px 60px rgba(74,55,40,0.2)" }}>
            <div style={{ padding: "18px 24px", background: T.gradient, color: "#fff", display: "flex", justifyContent: "space-between", alignItems: "center" }}>
              <div><div style={{ fontSize: 17, fontWeight: 700 }}>â˜• AI ì¼ê¸° ë¶„ì„</div><div style={{ fontSize: 11, opacity: 0.8 }}>{diaries.length}ê°œì˜ ì¼ê¸° ë¶„ì„ ê°€ëŠ¥</div></div>
              <button onClick={onClose} style={{ background: "rgba(255,255,255,0.2)", border: "none", color: "#fff", width: 34, height: 34, borderRadius: "50%", cursor: "pointer", fontSize: 16 }}>âœ•</button>
            </div>
            <div ref={ref} style={{ flex: 1, overflowY: "auto", padding: 20, background: T.bg }}>
              {msgs.map((m, i) => (
                <div key={i} style={{ display: "flex", justifyContent: m.role === "user" ? "flex-end" : "flex-start", marginBottom: 12 }}>
                  <div style={{ maxWidth: "82%", padding: "12px 18px", borderRadius: 16, background: m.role === "user" ? T.accent : T.card, color: m.role === "user" ? "#fff" : T.text, fontSize: 13, lineHeight: 1.7, whiteSpace: "pre-line", boxShadow: m.role === "ai" ? T.shadow : "none", borderBottomRightRadius: m.role === "user" ? 4 : 16, borderBottomLeftRadius: m.role === "ai" ? 4 : 16 }}>{m.text}</div>
                </div>
              ))}
              {loading && <div style={{ display: "flex" }}><div style={{ background: T.card, padding: "12px 20px", borderRadius: 16, fontSize: 13, color: T.textSub, boxShadow: T.shadow }}>ë¶„ì„ ì¤‘... â˜•</div></div>}
            </div>
            <div style={{ padding: 14, background: T.card, borderTop: `1px solid ${T.border}`, display: "flex", gap: 10 }}>
              <input value={input} onChange={e => setInput(e.target.value)} onKeyDown={e => e.key === "Enter" && send()} placeholder="ì¼ê¸°ì— ëŒ€í•´ ì§ˆë¬¸í•´ë³´ì„¸ìš”..." style={{ flex: 1, padding: "12px 18px", borderRadius: 24, border: `1px solid ${T.border}`, background: T.bg, fontSize: 13, outline: "none", color: T.text }} />
              <button onClick={send} disabled={loading} style={{ width: 42, height: 42, borderRadius: "50%", border: "none", background: input.trim() ? T.accent : T.border, color: "#fff", cursor: input.trim() ? "pointer" : "default", fontSize: 16, transition: "all 0.2s" }}>â†‘</button>
            </div>
          </div>
        </div>
      );
    };

    // â”€â”€â”€ Filter Modal â”€â”€â”€
    const FilterModal = ({ onClose, onApply, s, e, setS, setE }) => (
      <div style={{ position: "fixed", inset: 0, background: "rgba(74,55,40,0.4)", zIndex: 1000, display: "flex", alignItems: "center", justifyContent: "center", backdropFilter: "blur(4px)" }} onClick={onClose}>
        <div onClick={ev => ev.stopPropagation()} style={{ background: T.card, borderRadius: 24, padding: 32, width: 380, boxShadow: "0 20px 60px rgba(74,55,40,0.2)" }}>
          <div style={{ fontSize: 20, fontWeight: 700, color: T.text, marginBottom: 24 }}>ğŸ“… ë‚ ì§œ í•„í„°</div>
          <div style={{ marginBottom: 18 }}><label style={{ fontSize: 13, color: T.textSub, fontWeight: 600 }}>ì‹œì‘ ë‚ ì§œ</label><input type="date" value={s} onChange={ev => setS(ev.target.value)} style={{ width: "100%", padding: "12px 14px", borderRadius: 12, border: `1px solid ${T.border}`, marginTop: 6, fontSize: 14, background: T.bg, color: T.text, boxSizing: "border-box" }} /></div>
          <div style={{ marginBottom: 28 }}><label style={{ fontSize: 13, color: T.textSub, fontWeight: 600 }}>ë ë‚ ì§œ</label><input type="date" value={e} onChange={ev => setE(ev.target.value)} style={{ width: "100%", padding: "12px 14px", borderRadius: 12, border: `1px solid ${T.border}`, marginTop: 6, fontSize: 14, background: T.bg, color: T.text, boxSizing: "border-box" }} /></div>
          <div style={{ display: "flex", gap: 12 }}>
            <button onClick={() => { setS(""); setE(""); onApply(); }} style={{ flex: 1, padding: 14, borderRadius: 12, border: `1px solid ${T.border}`, background: T.card, fontSize: 14, fontWeight: 600, color: T.textSub, cursor: "pointer" }}>ì´ˆê¸°í™”</button>
            <button onClick={onApply} style={{ flex: 1, padding: 14, borderRadius: 12, border: "none", background: T.accent, color: "#fff", fontSize: 14, fontWeight: 600, cursor: "pointer" }}>ì ìš©</button>
          </div>
        </div>
      </div>
    );

    // â”€â”€â”€ Stats Tab â”€â”€â”€
    const StatsTab = ({ diaries }) => {
      const [cc, setCc] = useState(0);
      const [sp, setSp] = useState("all");
      const [cs, setCs] = useState("");
      const [ce, setCe] = useState("");
      const [showC, setShowC] = useState(false);
      const canUse = diaries.length >= 7;

      const fil = sp === "all" ? diaries : diaries.filter(d => { if (cs && d.date < cs) return false; if (ce && d.date > ce) return false; return true; });
      const ec = {}; fil.forEach(d => d.emotions.forEach(e => { ec[e.key] = (ec[e.key] || 0) + 1; }));
      const td = Object.entries(ec).sort((a, b) => b[1] - a[1]).map(([e, c]) => ({ value: c, count: c, emoji: EMOTIONS[e]?.emoji, label: EMOTIONS[e]?.label, color: EMOTIONS[e]?.color }));
      const kw = ["ìê¸°ì„±ì¥", "ì¹´í˜íƒë°©", "ì›Œë¼ë°¸", "ì¹œêµ¬", "ìƒˆë¡œìš´ê²½í—˜", "ë§›ì§‘", "ì‚°ì±…", "ì•¼ê·¼"];
      const sentence = "ìƒˆë¡œìš´ ê²½í—˜ì„ ì¦ê¸°ë©° ì¼ê³¼ ì‚¶ì˜ ê· í˜•ì„ ì°¾ì•„ê°€ëŠ” ë”°ëœ»í•œ ì‚¬ëŒ";
      const sec = { background: T.card, borderRadius: 16, padding: 24, marginBottom: 16, border: `1px solid ${T.border}` };

      if (!canUse) return (
        <div style={{ padding: 60, textAlign: "center" }}>
          <div style={{ fontSize: 64, marginBottom: 20 }}>ğŸ“Š</div>
          <div style={{ fontSize: 20, fontWeight: 700, color: T.text, marginBottom: 10 }}>í†µê³„ ê¸°ëŠ¥ì€ ì¤€ë¹„ ì¤‘ì´ì—ìš”</div>
          <div style={{ fontSize: 14, color: T.textSub, lineHeight: 1.6 }}>ì¼ì£¼ì¼ ì´ìƒ ì¼ê¸°ë¥¼ ì‘ì„±í•˜ë©´<br />í†µê³„ë¥¼ í™•ì¸í•  ìˆ˜ ìˆì–´ìš”</div>
          <div style={{ marginTop: 20, background: T.accentBg, borderRadius: 12, padding: 16, display: "inline-block" }}>
            <span style={{ fontSize: 14, color: T.textSub }}>í˜„ì¬ {diaries.length}ì¼ì§¸ Â· </span><span style={{ fontSize: 14, color: T.accent, fontWeight: 700 }}>{7 - diaries.length}ì¼ ë‚¨ìŒ</span>
          </div>
        </div>
      );

      return (
        <div>
          <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: 20 }}>
            <div style={{ fontSize: 16, fontWeight: 700, color: T.text }}>{sp === "all" ? "ğŸ“Š ì „ì²´ ê¸°ê°„ í†µê³„" : "ğŸ“Š ì»¤ìŠ¤í…€ ê¸°ê°„ í†µê³„"}</div>
            <div style={{ display: "flex", gap: 8 }}>
              <button onClick={() => { setSp("all"); setShowC(false); }} style={{ padding: "8px 18px", borderRadius: 10, border: "none", fontSize: 13, fontWeight: 600, background: sp === "all" ? T.accent : T.accentBg, color: sp === "all" ? "#fff" : T.accent, cursor: "pointer" }}>ì „ì²´</button>
              <button onClick={() => setShowC(!showC)} style={{ padding: "8px 18px", borderRadius: 10, border: "none", fontSize: 13, fontWeight: 600, background: sp === "custom" ? T.accent : T.accentBg, color: sp === "custom" ? "#fff" : T.accent, cursor: "pointer" }}>ì»¤ìŠ¤í…€ ({3 - cc}/3)</button>
            </div>
          </div>
          {showC && (
            <div style={{ background: T.accentBg, borderRadius: 12, padding: 18, marginBottom: 16, display: "flex", gap: 12, alignItems: "flex-end" }}>
              <div><div style={{ fontSize: 12, color: T.textSub, marginBottom: 4 }}>ì‹œì‘</div><input type="date" value={cs} onChange={ev => setCs(ev.target.value)} style={{ padding: "8px 12px", borderRadius: 10, border: `1px solid ${T.border}`, fontSize: 13, background: T.card }} /></div>
              <div><div style={{ fontSize: 12, color: T.textSub, marginBottom: 4 }}>ë</div><input type="date" value={ce} onChange={ev => setCe(ev.target.value)} style={{ padding: "8px 12px", borderRadius: 10, border: `1px solid ${T.border}`, fontSize: 13, background: T.card }} /></div>
              <button onClick={() => { if (cc >= 3) { alert("ì˜¤ëŠ˜ ì¡°íšŒ íšŸìˆ˜ë¥¼ ëª¨ë‘ ì‚¬ìš©í–ˆì–´ìš” (3/3)"); return; } setSp("custom"); setCc(c => c + 1); setShowC(false); }} style={{ padding: "8px 20px", borderRadius: 10, border: "none", background: T.accent, color: "#fff", fontSize: 13, fontWeight: 600, cursor: "pointer" }}>ì¡°íšŒ</button>
            </div>
          )}
          <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: 16, marginBottom: 16 }}>
            <div style={sec}><div style={{ fontSize: 14, fontWeight: 600, color: T.accent, marginBottom: 16 }}>ğŸ­ ê°ì • íŠ¸ë¦¬ë§µ</div><Treemap data={td} width={320} height={220} /></div>
            <div style={{ ...sec, display: "flex", flexDirection: "column", justifyContent: "space-between" }}>
              <div><div style={{ fontSize: 14, fontWeight: 600, color: T.accent, marginBottom: 16 }}>ğŸ·ï¸ AI ì„ ì • í‚¤ì›Œë“œ</div>
                <div style={{ display: "flex", flexWrap: "wrap", gap: 8 }}>{kw.map((k, i) => <span key={k} style={{ background: T.accentBg, color: T.accent, padding: "7px 16px", borderRadius: 20, fontSize: 13, fontWeight: 600, border: `1px solid ${T.border}` }}>#{k}</span>)}</div>
              </div>
              <div style={{ background: T.gradient, borderRadius: 14, padding: 20, color: "#fff", textAlign: "center", marginTop: 16 }}>
                <div style={{ fontSize: 12, opacity: 0.8, marginBottom: 8 }}>âœ¨ AIê°€ ë¶„ì„í•œ ë‚˜</div>
                <div style={{ fontSize: 15, fontWeight: 700, lineHeight: 1.6 }}>"{sentence}"</div>
              </div>
            </div>
          </div>
        </div>
      );
    };

    // â”€â”€â”€ Diary Card â”€â”€â”€
    const DiaryCard = ({ diary, onClick }) => (
      <div onClick={() => onClick(diary)} style={{ background: T.card, borderRadius: 16, padding: "22px 28px", marginBottom: 12, border: `1px solid ${T.border}`, cursor: "pointer", transition: "all 0.2s", boxShadow: T.shadow }}
        onMouseEnter={e => { e.currentTarget.style.boxShadow = T.shadowHover; e.currentTarget.style.transform = "translateY(-2px)"; }}
        onMouseLeave={e => { e.currentTarget.style.boxShadow = T.shadow; e.currentTarget.style.transform = "translateY(0)"; }}>
        <div style={{ display: "flex", justifyContent: "space-between", alignItems: "flex-start", marginBottom: 12 }}>
          <div>
            <div style={{ fontSize: 12, color: T.textSub, fontWeight: 500, marginBottom: 4 }}>
              {fmt(diary.date)}
              {isToday(diary.date) && <span style={{ background: T.accent, color: "#fff", fontSize: 10, padding: "2px 10px", borderRadius: 10, marginLeft: 8, fontWeight: 600 }}>ì˜¤ëŠ˜</span>}
            </div>
            <div style={{ fontSize: 18, fontWeight: 700, color: T.text }}>{diary.title}</div>
          </div>
          <div style={{ fontSize: 13, color: T.textSub, fontWeight: 600 }}>ğŸ’³ {money(diary.totalSpending)}</div>
        </div>
        <div style={{ display: "flex", gap: 6, marginBottom: 12, flexWrap: "wrap" }}>
          {diary.emotions.map(e => (
            <span key={e.key} style={{ background: EMOTIONS[e.key]?.color + "20", color: EMOTIONS[e.key]?.color, padding: "4px 12px", borderRadius: 20, fontSize: 12, fontWeight: 600, border: `1px solid ${EMOTIONS[e.key]?.color}30` }}>
              {EMOTIONS[e.key]?.emoji} {EMOTIONS[e.key]?.label}
            </span>
          ))}
        </div>
        <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center" }}>
          <div style={{ display: "flex", gap: 6, flexWrap: "wrap", flex: 1 }}>
            {diary.places.map((p, i) => (
              <span key={i} style={{ fontSize: 12, color: T.textSub, display: "flex", alignItems: "center", gap: 3 }}>
                {p.isFirst ? "âœ¨" : "ğŸ“"}{p.name}
                {p.isFirst && <span style={{ background: T.accent, color: "#fff", fontSize: 9, padding: "1px 6px", borderRadius: 6, fontWeight: 600, marginLeft: 2 }}>ì²«ë°©ë¬¸</span>}
              </span>
            ))}
          </div>
          <span style={{ fontSize: 12, color: T.accentLight, fontWeight: 500 }}>ìì„¸íˆ ë³´ê¸° â†’</span>
        </div>
      </div>
    );

    // â”€â”€â”€ Toast â”€â”€â”€
    const Toast = ({ onClose, onConfirm }) => (
      <div style={{ position: "fixed", inset: 0, background: "rgba(74,55,40,0.4)", zIndex: 1000, display: "flex", alignItems: "center", justifyContent: "center", backdropFilter: "blur(4px)" }} onClick={onClose}>
        <div onClick={e => e.stopPropagation()} style={{ background: T.card, borderRadius: 20, padding: 32, maxWidth: 400, textAlign: "center", boxShadow: "0 20px 60px rgba(74,55,40,0.2)" }}>
          <div style={{ fontSize: 48, marginBottom: 16 }}>ğŸ“</div>
          <div style={{ fontSize: 16, fontWeight: 700, color: T.text, marginBottom: 10 }}>ì˜¤ëŠ˜ ì¼ê¸°ë¥¼ ì´ë¯¸ ì‘ì„±í–ˆìŠµë‹ˆë‹¤</div>
          <div style={{ fontSize: 14, color: T.textSub, lineHeight: 1.6, marginBottom: 24 }}>ì¼ê¸°ë¥¼ ìˆ˜ì •í•˜ì‹¤ ìˆ˜ëŠ” ìˆìŠµë‹ˆë‹¤.<br />ìˆ˜ì •í•˜ì‹œê² ì–´ìš”?</div>
          <div style={{ display: "flex", gap: 12 }}>
            <button onClick={onClose} style={{ flex: 1, padding: 14, borderRadius: 12, border: `1px solid ${T.border}`, background: T.card, fontSize: 14, fontWeight: 600, color: T.textSub, cursor: "pointer" }}>ë‹«ê¸°</button>
            <button onClick={onConfirm} style={{ flex: 1, padding: 14, borderRadius: 12, border: "none", background: T.accent, color: "#fff", fontSize: 14, fontWeight: 600, cursor: "pointer" }}>ìˆ˜ì •í•˜ê¸°</button>
          </div>
        </div>
      </div>
    );

    // â”€â”€â”€ Main App â”€â”€â”€
    function App() {
      const [mainTab, setMainTab] = useState("diary");
      const [subTab, setSubTab] = useState("list");
      const [showFilter, setShowFilter] = useState(false);
      const [showAI, setShowAI] = useState(false);
      const [showToast, setShowToast] = useState(false);
      const [sd, setSd] = useState("");
      const [ed, setEd] = useState("");
      const [selectedDiary, setSelectedDiary] = useState(null);
      const todayWritten = true;

      const filtered = MOCK.filter(d => { if (sd && d.date < sd) return false; if (ed && d.date > ed) return false; return true; });
      const tabs = [
        { id: "diary", label: "ì¼ê¸°", icon: "ğŸ“" },
        { id: "community", label: "ì»¤ë®¤ë‹ˆí‹°", icon: "ğŸ‘¥" },
        { id: "meetup", label: "ë§Œë‚¨", icon: "ğŸ¤" },
        { id: "shopping", label: "ì‡¼í•‘", icon: "ğŸ›ï¸" },
        { id: "stats", label: "í†µê³„", icon: "ğŸ“Š" },
        { id: "mypage", label: "ë§ˆì´í˜ì´ì§€", icon: "ğŸ‘¤" },
      ];

      return (
        <div style={{ display: "flex", minHeight: "100vh", background: T.bg, fontFamily: "'Noto Sans KR', -apple-system, sans-serif" }}>
          {/* Left Sidebar Navigation (PC) */}
          <nav style={{ width: 220, background: T.card, borderRight: `1px solid ${T.border}`, padding: "28px 0", display: "flex", flexDirection: "column", position: "fixed", top: 0, left: 0, bottom: 0, zIndex: 50 }}>
            <div style={{ padding: "0 24px", marginBottom: 32 }}>
              <div style={{ fontSize: 22, fontWeight: 800, color: T.accent }}>í•˜ë£¨í•œì¤„</div>
              <div style={{ fontSize: 11, color: T.textSub, marginTop: 4 }}>ë‚˜ë§Œì˜ í•˜ë£¨ ê¸°ë¡</div>
            </div>
            <div style={{ flex: 1 }}>
              {tabs.map(t => (
                <button key={t.id} onClick={() => { setMainTab(t.id); setSubTab("list"); setSelectedDiary(null); }}
                  style={{
                    width: "100%", padding: "14px 24px", border: "none", background: mainTab === t.id ? T.accentBg : "transparent",
                    color: mainTab === t.id ? T.accent : T.textSub, fontSize: 14, fontWeight: mainTab === t.id ? 700 : 500,
                    cursor: "pointer", textAlign: "left", display: "flex", alignItems: "center", gap: 12,
                    borderRight: mainTab === t.id ? `3px solid ${T.accent}` : "3px solid transparent",
                    transition: "all 0.2s"
                  }}
                  onMouseEnter={e => { if (mainTab !== t.id) e.currentTarget.style.background = T.hover; }}
                  onMouseLeave={e => { if (mainTab !== t.id) e.currentTarget.style.background = "transparent"; }}>
                  <span style={{ fontSize: 18 }}>{t.icon}</span>{t.label}
                </button>
              ))}
            </div>
            <div style={{ padding: "16px 24px", borderTop: `1px solid ${T.border}`, fontSize: 11, color: T.textSub }}>v1.0.0 Â· í•˜ë£¨í•œì¤„</div>
          </nav>

          {/* Main Content */}
          <main style={{ marginLeft: 220, flex: 1, minHeight: "100vh" }}>
            {/* Top Bar */}
            <header style={{ background: T.card, borderBottom: `1px solid ${T.border}`, padding: "16px 40px", display: "flex", justifyContent: "space-between", alignItems: "center", position: "sticky", top: 0, zIndex: 40 }}>
              <div style={{ display: "flex", alignItems: "center", gap: 0 }}>
                {mainTab === "diary" && !selectedDiary && (
                  <div style={{ fontSize: 16, fontWeight: 700, color: T.text }}>ğŸ“ ì¼ê¸° ëª©ë¡</div>
                )}
                {mainTab === "stats" && (
                  <div style={{ fontSize: 16, fontWeight: 700, color: T.text }}>ğŸ“Š í†µê³„</div>
                )}
                {selectedDiary && <div style={{ fontSize: 15, fontWeight: 600, color: T.text }}>ğŸ“– ì¼ê¸° ìƒì„¸</div>}
              </div>
              <div style={{ display: "flex", gap: 10 }}>
                {mainTab === "diary" && !selectedDiary && (
                  <React.Fragment>
                    <button onClick={() => setShowFilter(true)} style={{ background: (sd || ed) ? T.accentBg : T.card, border: `1px solid ${(sd || ed) ? T.accentLight : T.border}`, borderRadius: 10, padding: "8px 18px", fontSize: 13, fontWeight: 600, color: (sd || ed) ? T.accent : T.textSub, cursor: "pointer", display: "flex", alignItems: "center", gap: 5, transition: "all 0.2s" }}
                      onMouseEnter={e => e.currentTarget.style.background = T.accentBg}
                      onMouseLeave={e => e.currentTarget.style.background = (sd || ed) ? T.accentBg : T.card}>
                      ğŸ“… í•„í„°{(sd || ed) ? " Â·" : ""}
                    </button>
                    <button onClick={() => setShowAI(true)} style={{ background: T.gradient, border: "none", borderRadius: 10, padding: "8px 18px", fontSize: 13, fontWeight: 600, color: "#fff", cursor: "pointer", display: "flex", alignItems: "center", gap: 5 }}>
                      â˜• AI ë¶„ì„
                    </button>
                    <button onClick={() => { if (todayWritten) setShowToast(true); else alert("ì¼ê¸° ì‘ì„±"); }}
                      style={{
                        background: todayWritten ? T.accentBg : T.accent, border: `1px solid ${todayWritten ? T.border : T.accent}`,
                        borderRadius: 10, padding: "8px 18px", fontSize: 13, fontWeight: 600,
                        color: todayWritten ? T.textSub : "#fff", cursor: "pointer", opacity: todayWritten ? 0.7 : 1,
                        display: "flex", alignItems: "center", gap: 5
                      }}>
                      âœï¸ ì¼ê¸°ì“°ê¸°
                    </button>
                  </React.Fragment>
                )}
              </div>
            </header>

            {/* Content Area */}
            <div style={{ padding: "28px 40px", maxWidth: 960 }}>
              {mainTab === "diary" && !selectedDiary && (
                <React.Fragment>
                  {(sd || ed) && (
                    <div style={{ background: T.accentBg, borderRadius: 10, padding: "10px 18px", marginBottom: 16, fontSize: 13, color: T.accent, fontWeight: 600, display: "flex", justifyContent: "space-between", alignItems: "center", border: `1px solid ${T.border}` }}>
                      <span>ğŸ” {sd || "ì²˜ìŒ"} ~ {ed || "í˜„ì¬"} ({filtered.length}ê°œ)</span>
                      <button onClick={() => { setSd(""); setEd(""); }} style={{ background: "none", border: "none", color: T.accent, cursor: "pointer", fontSize: 12, fontWeight: 700 }}>ì´ˆê¸°í™” âœ•</button>
                    </div>
                  )}
                  {filtered.map(d => <DiaryCard key={d.id} diary={d} onClick={setSelectedDiary} />)}
                  {filtered.length === 0 && (
                    <div style={{ textAlign: "center", padding: 80, color: T.textSub }}>
                      <div style={{ fontSize: 48, marginBottom: 16 }}>ğŸ“­</div>
                      <div style={{ fontSize: 16, fontWeight: 600 }}>í•´ë‹¹ ê¸°ê°„ì— ì‘ì„±ëœ ì¼ê¸°ê°€ ì—†ì–´ìš”</div>
                    </div>
                  )}
                </React.Fragment>
              )}
              {mainTab === "diary" && selectedDiary && (
                <DiaryDetail diary={selectedDiary} onBack={() => setSelectedDiary(null)} />
              )}
              {mainTab === "stats" && (
                <StatsTab diaries={MOCK} />
              )}
              {mainTab !== "diary" && mainTab !== "stats" && (
                <div style={{ textAlign: "center", padding: 100, color: T.textSub }}>
                  <div style={{ fontSize: 64, marginBottom: 20 }}>{tabs.find(t => t.id === mainTab)?.icon}</div>
                  <div style={{ fontSize: 20, fontWeight: 700, color: T.text, marginBottom: 8 }}>{tabs.find(t => t.id === mainTab)?.label}</div>
                  <div style={{ fontSize: 14 }}>ê³§ ì°¾ì•„ì˜¬ ì˜ˆì •ì´ì—ìš”!</div>
                </div>
              )}
            </div>
          </main>

          {showFilter && <FilterModal onClose={() => setShowFilter(false)} onApply={() => setShowFilter(false)} s={sd} e={ed} setS={setSd} setE={setEd} />}
          {showAI && <AIChatModal onClose={() => setShowAI(false)} diaries={MOCK} />}
          {showToast && <Toast onClose={() => setShowToast(false)} onConfirm={() => { window.location.href = "journal.html"; }} />}
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<App />);
  </script>
</body>
</html>
